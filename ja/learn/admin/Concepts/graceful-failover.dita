<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE concept PUBLIC "-//OASIS//DTD DITA Concept//EN" "concept.dtd">
<concept xml:lang="ja" id="concept_gvw_zsp_yn">
 <title>グレイスフルフェイルオーバ</title>
	
 <shortdesc>
	グレイスフルフェイルオーバは、実行中の操作が完了した後に、データを失うことなく、管理者が安全にノードをクラスタからフェイルオーバする方法を提供します。
 </shortdesc>
 
 <conbody>
  
	<p>
		 グレイスフルフェイルオーバを利用すると、すべての実行中の操作が完了するまで待ちます。
		 例えば、データをノードに書き込むプロセスや、データをレプリカvBucketに転送するプロセスの完了です。
		 レプリカvBucketはアクティブvBucketに昇格し、フェイルオーバしたノード上のアクティブvBucketは、レプリカvBucketになります。
		 これは、レプリカvBucketがアクティブvBucketと同期された後にフェイルオーバを実行するためで、
		 グレイスフルフェイルオーバはノードをフェイルオーバするのに、より時間がかかることがあります。
	</p>
  
	<p>
		サーバノードがグレイスフルフェイルオーバされている間(実行中の操作が完了するまで)、
		フェイルオーバを停止することが可能です。その後、グレイスフルフェイルオーバを再開することができます。
		ノードをフェイルオーバした後、<codeph>デルタ</codeph>もしくは、<codeph>フル</codeph>リカバリによってノードをクラスタに再追加することができます。
	</p>
  
   
	<note type="note">
		ハードフェイルオーバは即座にノードをクラスタからフェイルオーバするため、データロスが発生することがあります。
		ハードフェイルオーバは一般的にノードに障害が起きた場合に利用します。自動フェイルオーバはハードフェイルオーバです。
	</note>
  
	<p>
		グレイスフルフェイルオーバの実行には、以下の条件に一致する必要があります、一致しない場合、ハードフェイルオーバとなります。
	</p>
  
   <ul>
    <li>サーバノードが健全な状態である必要があります。</li>
	<li>フェイルオーバするサーバノードが保持するすべてのアクティブvBucketに対応するレプリカvBucketが必要です。</li>
    <li>少なくとも一つのレプリカvBucketが必ず必要です。</li>
    </ul>
  
  <p>例えば:</p>
  <ul>
	  <li>7ノードのクラスタでバケットのレプリカ数が1の場合、1台のノードのみ、グレイスフルフェイルオーバできます。</li>
	  <li>7ノードのクラスタでバケットのレプリカ数が2の場合、2台のノードのみ、グレイスフルフェイルオーバできます。</li>
	  <li>7ノードのクラスタでバケットのレプリカ数が3の場合、3台のノードのみ、グレイスフルフェイルオーバできます。</li>
  </ul>
  
  <p>
	  グレイスフルフェイルオーバでは、(ハードフェイルオーバと違って)アクティブvBucketの数が変化しません。
	  しかし、レプリカvBucketの数は減少し、不均一に分散された状態になります。
  </p>
   
   
   
   
  
  
  
  
   
 
    

   
   
   
  

  
  
  
 </conbody>
 
 <related-links>
  <linklist>
   <link href="delta-node-recovery.dita"/>

  </linklist>
 </related-links>
</concept>
