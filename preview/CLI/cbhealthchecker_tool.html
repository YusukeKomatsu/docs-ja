<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2015">
<meta name="DC.rights.owner" content="(C) Copyright 2015">
<meta name="DC.Type" content="reference">
<meta name="description" content="The cbhealthchecker tool generates a health report named Cluster Health Check Report for a cluster."><meta name="DC.Relation" scheme="URI" content="../cli-intro.html">
<meta name="DC.Relation" scheme="URI" content="../CLI/cbepctl-intro.html">
<meta name="DC.Relation" scheme="URI" content="../CLI/cbreset_password_tool.html">
<meta name="DC.Relation" scheme="URI" content="../Concepts/concepts-statsMonitor.html">
<meta name="DC.Relation" scheme="URI" content="../Concepts/concepts-TAP.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="cbhealthchecker_tool">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../commonltr.css">
<title>cbhealthchecker tool</title>
</head>
<body id="cbhealthchecker_tool">


	<h1 class="title topictitle1">cbhealthchecker tool</h1>

	
	<div class="body refbody"><p class="shortdesc">The <samp class="ph codeph">cbhealthchecker</samp> tool generates a health report named <em class="ph i">Cluster
		Health Check Report</em> for a cluster.</p>

		<div class="section"><h2 class="title sectiontitle">Description</h2>
		<p class="p">The report provides data that helps
			administrators, developers, and testers determine whether a cluster is healthy, has
			issues that must be addressed soon to prevent future problems, or has issues that must
			be addressed immediately.</p>

		<p class="p">The tool retrieves data from the Couchbase Server monitoring system, aggregates it over a
			time scale, analyzes the statistics against thresholds, and generates a report. Unlike
			other command line tools such as <samp class="ph codeph">cbstats</samp> and
				<samp class="ph codeph">cbtransfer</samp> that use the TAP protocol to obtain data from the monitoring system,
				<samp class="ph codeph">cbhealthchecker</samp> obtains data by using the REST API and the
			memcached protocol.</p>

		<p class="p">You can generate reports on the following time scales: minute, hour, day, week, month,
			and year. The tool outputs an HTML file, a text file, and a JSON file. Each file
			contains the same information â€” the only difference between them is the format of the
			information. All <samp class="ph codeph">cbhealthchecker</samp> output is stored in a
				<samp class="ph codeph">reports</samp> folder. The tool does not delete any files from the folder.
			You can delete files manually if the <samp class="ph codeph">reports</samp> folder becomes too large.
			The path to the output files is displayed when the run finishes.</p>

		<div class="note note"><span class="notetitle">Note:</span> <samp class="ph codeph">cbhealthchecker</samp> is automatically installed with Couchbase Server. You
			can find the tool in the following locations, depending upon your platform:</div>

		</div>

		
		<div class="section"><h2 class="title sectiontitle">CLI command and parameters</h2>
			<p class="p">This tool has the following options:</p>

			
			
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
					
					
					
					<thead class="thead" align="left">
						<tr class="row">
							<th class="entry" valign="top" width="33.33333333333333%" id="d40016e79">Option</th>

							<th class="entry" valign="top" width="33.33333333333333%" id="d40016e82">Syntax</th>

							<th class="entry" valign="top" width="33.33333333333333%" id="d40016e85">Description</th>

						</tr>

					</thead>

					<tbody class="tbody">
						<tr class="row">
							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e79 ">CLUSTER</td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e82 "><samp class="ph codeph">-c HOST[:PORT]</samp>
								<samp class="ph codeph">--cluster=HOST[:PORT]</samp></td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e85 ">Hostname and port of a node in the cluster. The default port is
								8091.</td>

						</tr>

						<tr class="row">
							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e79 ">USERNAME</td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e82 "><samp class="ph codeph">-u USERNAME</samp>
								<samp class="ph codeph">--user=USERNAME</samp></td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e85 ">Admin username of the cluster.</td>

						</tr>

						<tr class="row">
							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e79 ">PASSWORD</td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e82 "><samp class="ph codeph">-p PASSWORD</samp>
								<samp class="ph codeph">--password=PASSWORD</samp></td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e85 ">Admin password of the cluster.</td>

						</tr>

						<tr class="row">
							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e79 ">OPTIONS</td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e82 "><samp class="ph codeph">-b BUCKETNAME</samp>
								<samp class="ph codeph">--bucket=BUCKETNAME</samp></td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e85 ">Specific bucket on which to report. The default is all
								buckets.</td>

						</tr>

						<tr class="row">
							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e79 ">&nbsp;</td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e82 "><samp class="ph codeph">-i FILENAME</samp>
								<samp class="ph codeph">--input=FILENAME</samp></td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e85 ">Generate an analysis report from an input JSON file.</td>

						</tr>

						<tr class="row">
							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e79 ">&nbsp;</td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e82 "><samp class="ph codeph">-o FILENAME</samp>
								<samp class="ph codeph">--output=FILENAME</samp></td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e85 ">File name for the HTML report. The default output file name is the
								report time stamp, for example:
								<samp class="ph codeph">2013-07-26_13-26-23.html</samp>.</td>

						</tr>

						<tr class="row">
							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e79 ">&nbsp;</td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e82 "><samp class="ph codeph">-h</samp>
								<samp class="ph codeph">--help</samp></td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e85 ">Show the help message and exit.</td>

						</tr>

						<tr class="row">
							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e79 ">&nbsp;</td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e82 "><samp class="ph codeph">-s SCALE</samp>
								<samp class="ph codeph">--scale=SCALE</samp></td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e85 ">Time span (scale) for the statistics: minute, hour, day, week, month
								or year. The default time span is day.</td>

						</tr>

						<tr class="row">
							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e79 ">&nbsp;</td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e82 "><samp class="ph codeph">-j</samp>
								<samp class="ph codeph">--jsononly</samp></td>

							<td class="entry" valign="top" width="33.33333333333333%" headers="d40016e85 ">Collect data and output only a JSON file. When you use this option,
								the analysis report is not generated.</td>

						</tr>

					</tbody>

				</table>
</div>

		
		
		
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
				
				
				<thead class="thead" align="left">
					<tr class="row">
						<th class="entry" valign="top" width="50%" id="d40016e250">Operating System</th>

						<th class="entry" valign="top" width="50%" id="d40016e253">Location</th>

					</tr>

				</thead>

				<tbody class="tbody">
					<tr class="row">
						<td class="entry" valign="top" width="50%" headers="d40016e250 "><strong class="ph b">Linux</strong></td>

						<td class="entry" valign="top" width="50%" headers="d40016e253 "><samp class="ph codeph">/opt/couchbase/bin/</samp></td>

					</tr>

					<tr class="row">
						<td class="entry" valign="top" width="50%" headers="d40016e250 "><strong class="ph b">Windows</strong></td>

						<td class="entry" valign="top" width="50%" headers="d40016e253 "><samp class="ph codeph">C:\Program&nbsp;Files\Couchbase\Server\bin\</samp></td>

					</tr>

					<tr class="row">
						<td class="entry" valign="top" width="50%" headers="d40016e250 "><strong class="ph b">Mac OS X</strong></td>

						<td class="entry" valign="top" width="50%" headers="d40016e253 "><samp class="ph codeph">/Applications/Couchbase&nbsp;Server.app/Contents/Resources/couchbase-core/bin/</samp></td>

					</tr>

				</tbody>

			</table>
</div>

		</div>

		
		<div class="section"><h2 class="title sectiontitle">Syntax</h2>
		<p class="p">The format of the <samp class="ph codeph">cbhealthchecker</samp> command is:</p>

		<pre class="pre codeblock">cbhealthchecker CLUSTER USERNAME PASSWORD OPTIONS
</pre>

		</div>

		
		
		
		
		<div class="section"><h2 class="title sectiontitle">Examples</h2>
		<p class="p">The following command runs a report on all buckets in the cluster for the past day:</p>

		<pre class="pre codeblock">cbhealthchecker -c 10.3.1.10:8091 -u Administrator -p password

bucket: default
  node: 10.3.1.10 11210
  node: 10.3.1.11 11210
................................

The run finished successfully.
Please find html output at '/opt/couchbase/bin/reports/2013-07-23_16-29-02.html'
and text output at '/opt/couchbase/bin/reports/2013-07-23_16-29-02.txt'.
</pre>

		<p class="p">The following command runs a report on all buckets in the cluster for the past month:</p>

		<pre class="pre codeblock">cbhealthchecker -c 10.3.1.10:8091 -u Administrator -p password -s month

The run finished successfully.
Please find html output at '/opt/couchbase/bin/reports/2013-07-26_13-26-23.html'
and text output at '/opt/couchbase/bin/reports/2013-07-26_13-26-23.txt'.
</pre>

		<p class="p">The following command runs a report on only the <samp class="ph codeph">beer-sample</samp> bucket for
			the past year and outputs the HTML report to a file named
				<samp class="ph codeph">beer-health-report.html</samp>.</p>

		<pre class="pre codeblock">cbhealthchecker -c 10.3.1.10:8091 -u Administrator -p password -o beer-health-report.html \
      -b beer-sample -s year

The run finished successfully.
Please find html output at '/opt/couchbase/bin/reports/beer-health-report.html'
and text output at '/opt/couchbase/bin/reports/2013-07-26_15-57-11.txt'.
</pre>

		<p class="p">The following command generates only the statistics and outputs them in a JSON file:</p>

		<pre class="pre codeblock">cbhealthchecker -c 10.3.1.10:8091 -u Administrator -p password -j

The run finished successfully.
Please find collected stats at '/opt/couchbase/bin/reports/2013-07-26_13-30-36.json'.
</pre>

		</div>

		
		
		
		<div class="section"><h2 class="title sectiontitle">HTML Report</h2>
		<p class="p">You can view the HTML report in any web browser. If you copy the report to another
			location, be sure to copy all the files in the reports folder to ensure that the report
			is displayed correctly by the browser. When you have multiple HTML reports in the
			folder, you can use the tabs at the top of the page to display a particular report. (If
			the tabs do not function in your browser, try using Firefox.)</p>

		<p class="p">Throughout the report, normal health statuses are highlighted in green, warnings are
			highlighted in yellow, and conditions that require immediate action are highlighted in
			red. When viewing the report, you can hover your mouse over each statistic to display a
			message that describes how the statistic is calculated.</p>

		<p class="p">The report begins with a header that lists the statistics scale, the date and time the
			report was run, and an assessment of the overall health of the cluster. The following
			figure shows the report header:</p>

		<div class="fig fignone">
				<img class="image" src="../images/health-report-header.png" width="480">
			</div>

		
			<p class="p">The body of the report is divided into several sections: Couchbase â€” Alerts</p>

		
		<p class="p">The alerts section contains a list of urgent issues that require immediate attention. For
			each issue, the report lists the symptoms detected, the impact of the issue, and the
			recommended corrective action to take. This section appears in the report only when
			urgent issues are detected. The following figure shows a portion of the alerts section
			of a report:</p>

		
		<div class="fig fignone"><img class="image" src="../images/health-report-alerts.png" width="480"></div>

		
		
			<p class="p">Couchbase Cluster Overview:</p>

	
		<p class="p">The cluster overview section contains cluster-wide metrics and metrics for each bucket
			and node in the cluster. This section appears in all reports. The following figure shows
			a portion of the cluster overview section of a report:</p>

		
		<div class="fig fignone"><img class="image" src="../images/health-report-cluster-overview.png" width="480"></div>

		
		
			<p class="p">Couchbase â€” Warning Indicators:</p>

		
		<p class="p">The warning indicators section contains a list of issues that require attention. For each
			issue, the report lists the symptoms detected, the impact of the issue, and the
			recommended corrective action to take. This section appears in the report only when
			warning indicators are detected. The following figure shows a portion of the warning
			indicators section of a report:</p>

		
		<div class="fig fignone"><img class="image" src="../images/health-report-warnings.png" width="480"></div>

		</div>

		
	</div>

	<nav class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../cli-intro.html" title="Couchbase Server command-line interface (CLI) tools are provided to manage and monitor clusters, servers, vBuckets, XDCR, and so on.">CLI reference</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="../CLI/cbepctl-intro.html" title="The cbepctl tool is used to control vBucket states, configuration, and memory and disk persistence behavior.">cbepctl tool</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../CLI/cbreset_password_tool.html" title="The cbreset_password tool is used to reset an administrative or user read-only password.">cbreset_password tool</a></div>
</div>

<div class="linklist linklist">
<div><a class="link" href="../Concepts/concepts-statsMonitor.html" title="A complete set of statistical and monitoring information is provided through the Couchbase Web Console, CLI, and REST API.">Statistics and monitoring</a></div>
<div><a class="link" href="../Concepts/concepts-TAP.html" title="The TAP protocol is an internal part of the Couchbase Server system that is used to exchange data throughout the system.">TAP</a></div></div>
</nav>

</body>
</html>