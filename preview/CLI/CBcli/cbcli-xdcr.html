<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2015">
<meta name="DC.rights.owner" content="(C) Copyright 2015">
<meta name="DC.Type" content="reference">
<meta name="description" content="XDCR commands used with the couchbase-cli tool."><meta name="DC.Relation" scheme="URI" content="../../XDCR/xdcr-intro.html">
<meta name="DC.Relation" scheme="URI" content="../../Tasks/tasks-manage-xdcr-dataEncryption.html">
<meta name="DC.Relation" scheme="URI" content="../../Tasks/tasks-manage-xdcr.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="cbcli-xdcr">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../commonltr.css">
<title>XDCR</title>
</head>
<body id="cbcli-xdcr">


  <h1 class="title topictitle1">XDCR</h1>

  
  <div class="body refbody"><p class="shortdesc">XDCR commands used with the <samp class="ph codeph">couchbase-cli</samp> tool.</p>

    <div class="section"><h2 class="title sectiontitle">Description</h2>
      <p class="p">Remote XDCR replications, connections, and operations are managed with the following XDCR
        commands and options.</p>

      
    </div>

    
    <div class="section"><h2 class="title sectiontitle">CLI commands and parameters</h2>
      
      
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="cbcli-xdcr__table_drj_bcn_c4" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap">Table 1. couchbase-cli xdcr commands</span></caption>
          
          
          <thead class="thead" align="left">
            <tr class="row">
              <th class="entry" valign="top" width="33.44481605351171%" id="d1691e45">Command</th>

              <th class="entry" valign="top" width="66.5551839464883%" id="d1691e48">Description</th>

            </tr>

          </thead>

          <tbody class="tbody">
            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e45 ">xdcr-setup</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e48 ">Manage the XDCR replication configuration.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e45 ">setting-xdcr</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e48 ">Set XDCR related replication settings.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e45 ">xdcr-replicate</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e48 ">Manage the XDCR replication operations.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e45 ">ssl-manage</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e48 ">Manage cluster SSL certificate.</td>

            </tr>

            
          </tbody>

        </table>
</div>

      
      
      <p class="p">The following are <samp class="ph codeph">couchbase-cli xdcr-setup</samp> options.</p>

      
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="cbcli-xdcr__table_xdcr-setup" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap">Table 2. xdcr-setup options</span></caption>
          
          
          <thead class="thead" align="left">
            <tr class="row">
              <th class="entry" valign="top" width="33.44481605351171%" id="d1691e115">xdcr-setup options</th>

              <th class="entry" valign="top" width="66.5551839464883%" id="d1691e118">Description</th>

            </tr>

          </thead>

          <tbody class="tbody">
            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--create</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Creates a new XDCR configuration.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--edit</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Modifies an existing XDCR configuration.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--delete</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Deletes an existing XDCR configuration.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--list</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Lists all XDCR configurations.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--xdcr-cluster-name=[clustername]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Cluster name.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--xdcr-hostname=[hostname]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Remote host name to connect to.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--xdcr-username=[username]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Remote cluster administrator username.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--xdcr-password=[password</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Remote cluster administrator password.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--xdcr-demand-encryption=[0 | 1]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Enables and disables data encrypted using ssl. True is 1 and enables data encryption. False is 0 and disables data encryption. Default: 0</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e115 ">--xdcr-certificate=[certificate]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e118 ">Pem-encoded certificate. This self-signed certificate must be present if xdcr-demand-encryption is true.</td>

            </tr>

          </tbody>

        </table>
</div>

            
            
            <p class="p">The following are <samp class="ph codeph">couchbase-cli setting-xdcr</samp> options.</p>

            
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="cbcli-xdcr__table_setting-xdcr" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap">Table 3. setting-xdcr options</span></caption>
                
                
                <thead class="thead" align="left">
                  <tr class="row">
                    <th class="entry" valign="top" width="33.44481605351171%" id="d1691e240">setting-xdcr options</th>

                    <th class="entry" valign="top" width="66.5551839464883%" id="d1691e243">Description</th>

                  </tr>

                </thead>

                <tbody class="tbody">
                  <tr class="row">
                    <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e240 ">--max-concurrent-reps=[32]</td>

                    <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e243 ">Maximum concurrent replications per bucket, 8 to 256.</td>

                  </tr>

                  <tr class="row">
                    <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e240 ">--checkpoint-interval=[1800]</td>

                    <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e243 ">Intervals between checkpoints, 60 to 14400 seconds.</td>

                  </tr>

                  <tr class="row">
                    <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e240 ">--worker-batch-size=[500]</td>

                    <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e243 ">Document worker batch size, 500 to 10000.</td>

                  </tr>

                  <tr class="row">
                    <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e240 ">--doc-batch-size=[2049]KB</td>

                    <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e243 ">Document batching size, 10 to 100000 KB.</td>

                  </tr>

                  <tr class="row">
                    <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e240 ">--failure-restart-interval=[30]</td>

                    <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e243 ">Interval for restarting failed XDCR, 1 to 300 seconds.</td>

                  </tr>

                  <tr class="row">
                    <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e240 ">--optimistic-replication-threshold=[256]</td>

                    <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e243 ">Document body size threshold (bytes) to trigger optimistic replication.</td>

                  </tr>

                </tbody>

              </table>
</div>

      
     
      
      <p class="p">The following are <samp class="ph codeph">couchbase-cli xdcr-replicate</samp> options.</p>

      
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="cbcli-xdcr__table_xdcr-replicate" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap">Table 4. xdcr-replicate options</span></caption>
          
          
          <thead class="thead" align="left">
            <tr class="row">
              <th class="entry" valign="top" width="33.44481605351171%" id="d1691e330">xdcr-replicate options</th>

              <th class="entry" valign="top" width="66.5551839464883%" id="d1691e333">Description</th>

            </tr>

          </thead>

          <tbody class="tbody">
            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--create</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Create and start a new replication</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--delete</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Stop and cancel a replication</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--list</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">List all XDCR replications</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--pause</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Pause the replication</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--resume</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Resume the replication</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--settings</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Update settings for the replication</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--xdcr-replicator=[replicator]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Replication ID</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--xdcr-from-bucket=[bucket-name]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Local bucket name to replicate from</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--xdcr-cluster-name=[remote-cluster]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Remote cluster to replicate to</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--xdcr-to-bucket=[remote-bucket]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Remote bucket to replicate to</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--max-concurrent-reps =[ 16 ]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Maximum concurrent replications per bucket, 8 to 256. Default: 16</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--checkpoint-interval =[ 1800 ]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Intervals between checkpoints , 60 to 14400 seconds</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--worker-batch-size =[ 500 ]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Document worker batch size, 500 to 10000</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--doc-batch size =[ 2048 ] KB</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Document batch size, 10 to 100000 KB</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--failure-restart-interval =[ 30 ]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Interval for restarting failed xdcr, 1 to 300 seconds</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--optimistic-replication-threshold =[ 256 ]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Document body size threshold (bytes) to trigger optimistic replication</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="33.44481605351171%" headers="d1691e330 ">--xdcr-replication-mode=[xmem | capi]</td>

              <td class="entry" valign="top" width="66.5551839464883%" headers="d1691e333 ">Replication protocol, either capi or xmem</td>

            </tr>

          </tbody>

        </table>
</div>

      
      <p class="p">The following are <samp class="ph codeph">couchbase-cli ssl-manage</samp> options. This option is
        available for Enterprise Edition only.</p>

      
      
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="cbcli-xdcr__table_ssl-manage" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap">Table 5. ssl-manage command options</span></caption>
          
          
          <thead class="thead" align="left">
            <tr class="row">
              <th class="entry" valign="top" width="50%" id="d1691e519">ssl-manage options (Enterprise Edition only)</th>

              <th class="entry" valign="top" width="50%" id="d1691e522">Description</th>

            </tr>

          </thead>

          <tbody class="tbody">
            <tr class="row">
              <td class="entry" valign="top" width="50%" headers="d1691e519 ">--retrieve-cert=[certificate]</td>

              <td class="entry" valign="top" width="50%" headers="d1691e522 ">Retrieves the self-signed certificate from the destination cluster to the
                source cluster. Specify a local location (full path) and file name for the
                pem-encoded certificate. For example,
                <samp class="ph codeph">--retrieve-cert=./newCert.pem</samp>.</td>

            </tr>

            <tr class="row">
              <td class="entry" valign="top" width="50%" headers="d1691e519 ">--regenerate-cert=[certificate]</td>

              <td class="entry" valign="top" width="50%" headers="d1691e522 ">Regenerates a self-signed certificate on the destination cluster. Specify the
                full path for the location of the pem-encoded certificate file. For example,
                <samp class="ph codeph">--regenerate-cert=./newRegen.pem</samp>.</td>

            </tr>

          </tbody>

        </table>
</div>

    
    </div>

    

    <div class="section"><h2 class="title sectiontitle">Example: Creating a remote cluster reference</h2>
      <p class="p">To create a remote cluster reference:</p>

      <pre class="pre codeblock">couchbase-cli xdcr-setup -c 10.3.121.121:8091 -u Administrator  -p password 
    --create 
    --xdcr-cluster-name=RemoteCluster  
    --xdcr-hostname=10.3.121.123:8091  
    --xdcr-username=Administrator  
    --xdcr-password=password
</pre>

      
      

      
      <p class="p">Upon success, the following response is returned:</p>

      <pre class="pre codeblock">SUCCESS: init RemoteCluster</pre>

      
      <p class="p">Now, you can start replication to the remote cluster using memcached protocol as the existing
        default:</p>

      
      <pre class="pre codeblock">couchbase-cli xdcr-replicate -c 10.3.121.123:8091 -u Administrator -p password 
        --xdcr-cluster-name RemoteCluster 
        --xdcr-from-bucket default 
        --xdcr-to-bucket backup
      </pre>

      
      <p class="p">An XDCR protocol for the mode of replication can be specified for XDCR. 
        To explicitly set the protocol to memcached:</p>

      
      <pre class="pre codeblock">couchbase-cli xdcr-replicate -c 10.3.121.123:8091 -u Administrator -p password
    --xdcr-cluster-name RemoteCluster 
    --xdcr-from-bucket default 
    --xdcr-to-bucket backup 
    --xdcr-replication-mode xmem
      </pre>

      
      <p class="p">To set the protocol to CAPI:</p>

      
      <pre class="pre codeblock">couchbase-cli xdcr-replicate -c 10.3.121.123:8091 -u Administrator -p password
    --xdcr-cluster-name=RemoteCluster 
    --xdcr-from-bucket=default 
    --xdcr-to-bucket=backup
    --xdcr-replication-mode=capi
      </pre>

      
      <p class="p">To change a XDCR replication protocol for an existing XDCR replication:</p>

      
      <ol class="ol">
        <li class="li">Delete the replication.</li>

        <li class="li">Re-create the replication with your preference.</li>

      </ol>

      
      <p class="p">If there is already an existing replication for a bucket, you get an error when starting the
        replication again with new settings:</p>

      <pre class="pre codeblock">couchbase-cli xdcr-replicate -c 10.3.121.121:8091 -u Administrator -p password 
    --xdcr-cluster-name=RemoteCluster 
    --xdcr-from-bucket=default 
    --xdcr-to-bucket=backup
    --xdcr-replication-mode=capi
      </pre>

      
      <p class="p">Results in the following error:</p>

      <pre class="pre codeblock">ERROR: unable to create replication (400) Bad Request
        {u'errors': {u'_': u'Replication to the same remote cluster and bucket already exists'}}
ERROR: Replication to the same remote cluster and bucket already exists
      </pre>

    </div>

    
    <div class="section"><h2 class="title sectiontitle">Example: Listing XDCR remote clusters</h2>
      <p class="p">In the following example, the <samp class="ph codeph">couchbase-cli xdcr-setup</samp> command is executed 
        from the local host and the specified host is the remote host. 
        To list all XDCR configurations:</p>

      <pre class="pre codeblock">
couchbase-cli xdcr-setup 
  -c 10.5.2.117:8091 
  -u Administrator -p password 
  --list        
      </pre>

    </div>

    
    <div class="section"><h2 class="title sectiontitle">Example: Listing XDCR replication streams</h2>
      
      <p class="p">In the following example, the <samp class="ph codeph">couchbase-cli xdcr-replicate</samp> command is executed 
        from the local host and the specified host is the remote host. 
        To list all XDCR replication streams:</p>

      <pre class="pre codeblock">
couchbase-cli xdcr-replicate 
  -c 10.5.2.117:8091 
  -u Administrator -p password 
  --list        
      </pre>

    </div>

    
    <div class="section"><h2 class="title sectiontitle">Response</h2>
      <p class="p">The follow response example is for the <samp class="ph codeph">couchbase-cli xdcr-setup --list</samp>
        command option and shows the local host, UUID, URI, and user name:</p>

      <pre class="pre codeblock">
cluster name: source1
      uuid: bfa861d3734c90559522a88b9db81606
      host name: 10.5.2.54:8091
      user name: Administrator
      uri: /pools/default/remoteClusters/source1
      </pre>

      
      
      <p class="p">The follow response example is for the <samp class="ph codeph">couchbase-cli xdcr-replicate --list</samp>
        command option and shows the replication stream from the source bucket to the remote
        bucket:</p>

      <pre class="pre codeblock">
stream id: bfa861d3734c90559522a88b9db81606/test2/test
   status: running
   source: test2
   target: /remoteClusters/bfa861d3734c90559522a88b9db81606/buckets/test
      </pre>

    
    
    </div>




  </div>

  <nav class="related-links">
<div class="linklist linklist">
<div><a class="link" href="../../XDCR/xdcr-intro.html" title="XDCRは、主に災害復旧のために、あるクラスタのデータを別のクラスタに複製します。">クロスデータセンターレプリケーション（XDCR）</a></div>
<div><a class="link" href="../../Tasks/tasks-manage-xdcr-dataEncryption.html">Managing XDCR data encryption</a></div>
<div><a class="link" href="../../Tasks/tasks-manage-xdcr.html" title="Cross datacenter replication (XDCR) provides an easy method of replicating data from one cluster to another for disaster recovery as well as better data locality (getting data closer to its users).">Managing XDCR</a></div></div>
</nav>

</body>
</html>