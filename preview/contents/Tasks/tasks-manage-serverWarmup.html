<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Handling server warmup</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../assets/stylesheets/application.css"><link rel="stylesheet" href="../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation"><header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><a href="http://www.couchbase.com/learn" class="developer-porta-header__navigation__back">
							Return to Learn
						</a><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/developer">Developer Documentation</a></li><li class="developer-portal-header__navigation__item"><a href="http://developer.couchbase.com/mobile">Couchbase Mobile</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li><li class="developer-portal-header__navigation__item"><a href="http://docs.couchbase.com/archive-index">Documentation Archives</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><div class="developer-portal-sidebar__versions"><ul id="developer-portal-versions-navigation"><li class="active"><a href="#"><span>Version 3.0</span></a></li><li class=""><a href="http://docs.couchbase.com/archive-index"><span>Older</span></a></li></ul></div><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../Couchbase-intro.html"><span>はじめに</span></a></li><li class="section"><a href="../Whats-new-3.0.html"><span>3.0の新機能</span></a></li><li class="section section--has-sub-sections"><a href="../install-intro.html"><span>インストールとアップグレード</span></a></li><li class="section section--has-sub-sections section--active"><a href="../admin-intro.html"><span>Couchbase Serverの管理</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../Misc/admin-basics.html"><span>管理の基礎</span></a></li><li class="section section--has-sub-sections"><a href="../Concepts/concept-intro.html"><span>アーキテクチャと概念</span></a></li><li class="section section--has-sub-sections"><a href="../security/security-intro.html"><span>セキュリティ</span></a></li><li class="section section--has-sub-sections"><a href="../Concepts/bp-deployment-considerations.html"><span>デプロイ構成の考慮事項</span></a></li><li class="section section--has-sub-sections section--active"><a href="../Tasks/cluster-management.html"><span>クラスタ管理</span></a><ul class="sub-sections"><li class="section"><a href="../Tasks/tasks-manage-serverWarmup.html" class="current"><span>Handling server warmup</span></a><ul class="sub-sections"></ul></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-manage-replication.html"><span>Handling replication</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-compaction.html"><span>Compacting data files</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/cluster-maintenance.html"><span>Cluster maintenance</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/maintenance-server-node.html"><span>Server maintenance</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-backup-restore.html"><span>Backup and restore</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-manage-xdcr.html"><span>Managing XDCR</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../Monitoring/monitor-intro.html"><span>モニタリング</span></a></li><li class="section section--has-sub-sections"><a href="../XDCR/xdcr-intro.html"><span>クロスデータセンターレプリケーション（XDCR）</span></a></li><li class="section section--has-sub-sections"><a href="../UI/ui-intro.html"><span>Webコンソール</span></a></li><li class="section"><a href="../Misc/faq.html"><span>FAQ</span></a></li><li class="section section--has-sub-sections"><a href="../Misc/Trbl-intro.html"><span>トラブルシューティング</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
 <h1 class="title topictitle1">Handling server warmup</h1>

 
 
 
 <div class="body"><p class="shortdesc">Couchbase server warmup behavior can be modified by changing the access scanner and warmup
  threshold settings via the <samp class="ph codeph">cbepctl</samp> tool.</p>


 <p class="p"> In order to adjust warmup behavior, it is important to understand the access log
  and scanning process in Couchbase Server. </p>

  <p class="p">The server uses the access log to determine which
  documents are most frequently used, and therefore which documents to load first. 
  It has a process that periodically scans every key in RAM and compiles them into a log 
   named <samp class="ph codeph">access.log</samp>. It also maintains a backup of this access log, named
    <samp class="ph codeph">access.old</samp>.</p>
 
   <p class="p">The server can use this backup file during warmup if the most
   recent access log has been corrupted during warmup or node failure. By default, this process runs
   initially at 2:00 GMT and then again each 24 hour time periods. You can configure
   this process to run at a different initial time and at a different fixed interval.</p>

  
  <p class="p">If a client tries to contact Couchbase Server during warmup, the server produces a
    <samp class="ph codeph">ENGINE_TMPFAIL (0x0d)</samp> error code. This error indicates that data access is
   still not available because warmup has not yet finished. </p>

   
   <div class="note note"><span class="notetitle">Note:</span> If you are creating your
   own Couchbase SDK, you need to handle this error in your library. This may mean that the
   client waits and retries, performs a backoff of requests, or produces an error
   and does not retry the request. </div>

   
   <div class="note note"><span class="notetitle">Note:</span> If you are building an application with a Couchbase
   SDK, be aware that delivery and handling of this error depends on the individual SDKs.
   </div>

   
<p class="p">These are the actions to take during Couchbase Server warmup:</p>

  
  <dl class="dl">
   
    <dt class="dt dlterm">Getting warmup information</dt>

    <dd class="dd">The <samp class="ph codeph">cbstats</samp> tool is used to
     get information about server warmup, including the warmup status and whether warmup is enabled.</dd>

   
  </dl>

<dl class="dl">
 
  <dt class="dt dlterm">Changing the warmup threshold</dt>

  <dd class="dd">Modify warmup behavior by changing the
   <samp class="ph codeph">cbepctl ep_warmup_min_items_threshold</samp> parameter. This indicates the percentage
   of items loaded in RAM that must be reached for Couchbase Server to begin serving data. The
   lower this number, the sooner your server can begin serving data. Be aware, however that if you
   set this value to be too low, once requests come in for items, the item may not be in memory and
   Couchbase Server will experience cache-miss errors.</dd>

 
</dl>

  <dl class="dl">
   
    <dt class="dt dlterm">Changing access scanner settings</dt>

    <dd class="dd">The server runs a periodic scanner process which determines which keys are most frequently-used, and therefore, which documents
     should be loaded first during server warmup. The settings, <samp class="ph codeph">cbepctl flush_param</samp>
     <samp class="ph codeph">alog_sleep_ time</samp> and <samp class="ph codeph">alog_task_ time</samp>parameters are used to
     change the initial time and the interval for the process.</dd>

   
  </dl>



 </div>

 
 <nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../Tasks/cluster-management.html" title="運用で重要となるCouchbase Serverクラスタ管理について説明します。">クラスタ管理</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../Tasks/tasks-manage-replication.html" title="Data replication is distributed throughout the Couchbase cluster to prevent a single point of failure. Data replication is configurable on a bucket-level and node-basis.">Handling replication</a></div>
</div>

<div class="linklist linklist">
<div><a class="link" href="../CLI/cbepctl-intro.html" title="The cbepctl tool is used to control vBucket states, configuration, and memory and disk persistence behavior.">cbepctl tool</a></div>
<div><a class="link" href="../CLI/CBepctl/cbepctl-accesslog.html" title="Access log settings determine when the access scanner process initially runs and how often.">Changing access log settings</a></div>
<div><a class="link" href="../CLI/cbstats-intro.html" title="The cbstats tool is used to get node and cluster-level statistics about performance and items in storage.">cbstats tool</a></div></div>
</nav>
</div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b> All rights reserved.</span><a href="http://www.couchbase.com/developers">Developer Portal</a><a href="http://forums.couchbase.com">Forums</a><a href="http://www.couchbase.com/downloads">Download</a><a href="http://support.couchbase.com/">Customer Support Login</a></p></footer></div></main><script src="../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../';</script><script src="../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>