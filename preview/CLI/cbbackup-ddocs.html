<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2015">
<meta name="DC.rights.owner" content="(C) Copyright 2015">
<meta name="DC.Type" content="reference">
<meta name="description" content="Design documents are backed up with the design_doc_only=1 option."><meta name="DC.Relation" scheme="URI" content="../CLI/cbbackup_tool.html">
<meta name="DC.Relation" scheme="URI" content="../CLI/cli-increment-backup.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="cbbackup-ddocs">
<link rel="stylesheet" type="text/css" href="../commonltr.css">
<title>Backing up design documents</title>
</head>
<body id="cbbackup-ddocs">


  <h1 class="title topictitle1">Backing up design documents</h1>

  
  <div class="body refbody"><p class="shortdesc">Design documents are backed up with the <samp class="ph codeph">design_doc_only=1</samp> option.</p>

     <div class="section"><h2 class="title sectiontitle">Description</h2>

    <p class="p">Backup only design documents from a cluster or bucket with the option,
               <samp class="ph codeph">design_doc_only=1</samp>. Restore only design documents with
               <samp class="ph codeph">cbrestore design_doc_only=1</samp>.</p>

     </div>

     
     <div class="section"><h2 class="title sectiontitle">Syntax</h2>
        <p class="p">Basic syntax:</p>

        <pre class="pre codeblock">cbbackup http://[host]:8091 [backup-location] -x design_doc_only=1 -b [bucket-name]</pre>

     </div>

     
     <div class="section"><h2 class="title sectiontitle">Example</h2>
        <p class="p">The following example creates a backup copy
           of all design documents from <samp class="ph codeph">foo-bucket</samp> and store this as
           <samp class="ph codeph">design.json</samp> in the directory <samp class="ph codeph">~/backup/foo-bucket</samp>.
           If a bucket is not specified, design documents for all buckets in the cluster are backed
           up. </p>


    <pre class="pre codeblock">cbbackup http://10.5.2.117:8091 ~/backup -x design_doc_only=1</pre>

    
    
    
    
        </div>

     
     <div class="section"><h2 class="title sectiontitle">Response</h2>
        <p class="p">The following example response shows only design documents for all buckets being backed up. 
        In this case, the source node had two (2) buckets including the default bucket.</p>

        <pre class="pre codeblock">
transfer design doc only. bucket msgs will be skipped.
transfer design doc only. bucket msgs will be skipped.
done
        </pre>

        
     <p class="p">In the following output, two design documents were backed up.</p>

    
    <pre class="pre codeblock">[
   {
      "controllers":{
         "compact":"/pools/default/buckets/default/ddocs/_design%2Fddoc1/controller/compactView",
         "setUpdateMinChanges":"/pools/default/buckets/default/ddocs/_design%2Fddoc1/controller/setUpdateMinChanges"
      },
      "doc":{
         "json":{
            "views":{
               "view1":{
                  "map":"function(doc){emit(doc.key,doc.key_num);}"
               },
               "view2":{
                  "map":"function(doc,meta){emit(meta.id,doc.key);}"
               }
            }
         },
         "meta":{
            "rev":"1-6f9bfe0a",
            "id":"_design/ddoc1"
         }
      }
   },
   {
      "controllers":{
         "compact":"/pools/default/buckets/default/ddocs/_design%2Fddoc2/controller/compactView",
         "setUpdateMinChanges":"/pools/default/buckets/default/ddocs/_design%2Fddoc2/controller/setUpdateMinChanges"
      },
      "doc":{
         "json":{
            "views":{
               "dothis":{
                  "map":"function (doc, meta) {\n  emit(meta.id, null);\n}"
               }
            }
         },
         "meta":{
            "rev":"1-4b533871",
            "id":"_design/ddoc2"
         }
      }
   },
   {
      "controllers":{
         "compact":"/pools/default/buckets/default/ddocs/_design%2Fdev_ddoc2/controller/compactView",
         "setUpdateMinChanges":"/pools/default/buckets/default/ddocs/_design%2Fdev_ddoc2/controller/setUpdateMinChanges"
      },
      "doc":{
         "json":{
            "views":{
               "dothat":{
                  "map":"function (doc, meta) {\n  emit(meta.id, null);\n}"
               }
            }
         },
         "meta":{
            "rev":"1-a8b6f59b",
            "id":"_design/dev_ddoc2"
         }
      }
   }
]
</pre>

     </div>

  </div>

<nav class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../CLI/cbbackup_tool.html" title="cbbackupツールは、稼働中の全クラスタ・全バケット・単一ノード・正常稼働中ノード上の単一バケット のコピーを作成します。">cbbackupツール</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../CLI/cli-increment-backup.html" title="Incremental backups are run by using the cbbackup command-line tool.">Backing up incrementally</a></div>
</div>
</nav>
</body>
</html>