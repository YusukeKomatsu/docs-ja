<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference xml:lang="ja" id="rest-bucket-delete">
	<title>bucketの削除</title>
	<shortdesc>bucketを削除する時は、<codeph>DELETE /pools/default/buckets/[bucket-name]</codeph>HTTPメソッドとURIを使用します。</shortdesc>
	
	<refbody>
		
		<section><title>説明</title>
			<p>
				Bucketの削除は同期処理です。クラスタに複数サーバがある場合、いくつかのサーバで標準的なタイムアウトの30秒以内にbucketの削除ができない場合があります。
			</p>
			<ul>
				<li>
					標準的なタイムアウトの30秒以内に全てのサーバでbucketが削除された場合、レスポンスコード<codeph>200</codeph> が返ってきます。
				</li>
				<li>
					30秒のタイムアウト以内に全てのサーバでbucketの削除が終わらなかった場合、エラーコード <codeph>500</codeph> が返ってきます。
				</li>
				<li>
					bucketが全てのサーバで削除されず、他のリクエストでbucketが削除されていた場合、エラーコード <codeph>404</codeph> が返ってきます。
				</li>
				<li>
					bucketが全てのサーバでの削除されず、同じ名前で新しいbucketを作成するリクエストがあった場合、bucketがまだ削除中であることを示すエラーが返ってくる事があります。
				</li>
			</ul>
			
			<note type="warning">
				この操作はデータを破壊します。
				サービスはユーザとダブルチェックは行いません。
				後戻りすることは出来ません。
				クライアントアプリケーションでの削除操作はエンドユーザとのダブルチェックを行ったあとに実行することをおすすめします。
			</note>
		</section>
		
		<section>
			<title>HTTPメソッドとURI</title>

			<codeblock>DELETE /pools/default/buckets/[bucket-name]</codeblock>
			<table>
			<tgroup cols="2">
				<colspec colname="col1"/>
				<colspec colname="col2"/>
				<tbody>
					<row>
						<entry><b>レスポンスデータ</b></entry>
						<entry>None</entry>
					</row>
					<row>
						<entry><b>レスポンスデータ</b></entry>
						<entry>None</entry>
					</row>
					<row>
						<entry><b>認証の要・不要</b></entry>
						<entry>Yes</entry>
					</row>
				</tbody>
			</tgroup>
		</table>
		
		
			
		</section>
		
		<section><title>シンタックス</title>
			<p>Curlリクエストシンタックス:</p>
			<codeblock>curl -u [admin]:[password]
http://[localhost]:8091//pools/default/buckets/[bucket-name]</codeblock>
			
			<p>Raw HTTPリクエストシンタックス:</p>
			<codeblock>DELETE /pools/default/buckets/[bucket-name]
Host: [localhost]:8091
Authorization: Basic xxxxxxxxxxxxxxxxxxx
</codeblock>
		</section>
		
		<section><title>例</title>
			<p>myTestBucketという名前のbucketを削除するときのCurlリクエスト例:</p>
			<codeblock>curl -u Administrator:password
http://10.5.2.54:8091/pools/default/buckets/myTestBucket</codeblock>
			
			<p>myTestBucketという名前のbucketを削除するときのRaw HTTPリクエスト例:</p>
			<codeblock>DELETE /pools/default/buckets/myTestBucket
Host: 10.5.2.54:8091
Authorization: Basic xxxxxxxxxxxxxxxxxxx
</codeblock>
		</section>
		

	
	<section>
		<title>レスポンスコード</title>
		<table>
			<tgroup cols="2">
					<colspec colname="col1" colwidth="1*"/>
					<colspec colname="col2" colwidth="2.85*"/>
					<thead>
						<row>
							<entry>レスポンスコード</entry>
							<entry>説明</entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>200</entry>
							<entry>全てのノードでbucketが削除できた</entry>
						</row>
						<row>
							<entry>401</entry>
							<entry>認証失敗</entry>
						</row>
						<row>
							<entry>404</entry>
							<entry>オブジェクトが見つからない</entry>
						</row>
						<row>
							<entry>500</entry>
							<entry>Bucketが全てのノード上で削除されなかった</entry>
						</row>
						<row>
							<entry>503</entry>
							<entry>リバランス中でbucketが削除できなかった</entry>
						</row>
					</tbody>
				</tgroup>
		</table>
	</section>
		
	</refbody>
</reference>
