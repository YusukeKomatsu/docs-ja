<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference xml:lang="ja" id="rest-bucket-flush">
  <title>bucketのフラッシュ</title>
  <shortdesc>To flush all buckets, use the <codeph>POST
      /pools/default/buckets/default/controller/doFlush</codeph> HTTP method and URI.</shortdesc>
  
  <refbody>
    <section><title>説明</title>
    
    <p>
      <codeph>doFlush</codeph>オペレーションは指定のbucketのコンテンツを格納されているデータを全て削除し空にします。
      設定したbucketでflushが有効な場合のみ、操作が成功します。
    </p>
    
    <note type="warning">
      このオペレーションはデータを破棄します。サービスは実行確認したり、ダブルチェックのリクエストをしようとしません。
      これを使用してクライアントアプリケーションはそのようなリクエストを送信する前にエンドユーザとダブルチェックすることを推奨します。
      Couchbase Web コンソール内でbucket上の<codeph>flushEnabled</codeph>パラメータを設定したり、<codeph>cbepctl flush_param</codeph>を通して、個別のbucketのフラッシュする機能を制限したりコントロールすることが出来ます。</note>
      
      <p>
        パラメータやペイロードデータは無視されますが、システムが保護されている場合、リクエストは認証ヘッダを含む必要があります。
      </p>
      
      <note type="important">
        フラッシュリクエストはbucket内のデータがデータベースが削除されるのと同じくらいのかなりのディスクアクティビティになる可能性があります。
        データが正常に削除されるまで、高いディスク使用率はサーバのパフォーマンスに影響をあたえる可能性があります。
      </note>
      
      <note type="note">
        フラッシュリクエストはXDCRレプリケーション構成上で送信されません。リモートbucketはフラッシュされません。
      </note>
      <p>
        Couchbase Serverは、URLが無効だったり、システム上の有効なbucketと一致しない場合、HTTP 404 レスポンスを返します。
      </p>
    </section>
    
    
    <section><title>HTTPメソッドとURI</title>
      <codeblock>POST /pools/default/buckets/default/controller/doFlush</codeblock>
    </section>
    
    <section><title>シンタックス</title>
      <p>Curlリクエストシンタックス:</p>
      <codeblock>curl -X POST -u [admin]:[password]
  http://[localhost]:8091/pools/default/buckets/default/controller/doFlush
      </codeblock>
      
      <p>Raw HTTPリクエストシンタックス:</p>
      <codeblock>POST /pools/default/buckets/default/controller/doFlush
Host: localhost:8091
Authorization: Basic xxxxxxxxxxxxxxxxxxx
      </codeblock>
    </section>
    
    <section><title>例</title>
      <p>Curlリクエスト例:</p>
      <codeblock>
curl -X POST 'http://admin:password@localhost:8091/pools/default/buckets/default/controller/doFlush'
  </codeblock>
      
      <p>Raw HTTPリクエスト例:</p>
      <codeblock>POST /pools/default/buckets/default/controller/doFlush
Host: 10.5.2.54:8091
Authorization: Basic xxxxxxxxxxxxxxxxxxx
      </codeblock>
    </section>
    
    
    <section><title>レスポンスコード</title>
      <p>If the flush is successful, the HTTP response code is <codeph>200</codeph> is returned.</p>
      <codeblock>HTTP/1.1 200 OK</codeblock>
      
      <p>指定したbucketでフラッシュが無効だった場合、レスポンスコード400と一緒にbucketの状態が返ってきます。例:</p>
      <codeblock>{"_":"Flush is disabled for the bucket"}</codeblock>
      
    <p>bucketが存在しなかった場合、レスポンスコード404が返ってきます。</p>
    <codeblock>404 Not Found</codeblock>
    </section>

  </refbody>
</reference>
